# 添加和删除

[TOC]

## 1、删除表格某行数据

### 1.1 前言

删除的思路其实和修改的思路差不多，可以参考前面的修改。

### 1.2 前端

- Data.vue

  ```vue
  <el-table-column fixed="right" label="操作" width="160">
                <template slot-scope="scope">
                  <el-button
                    type="primary"
                    plain
                    size="mini"
                    @click="handleEdit(scope.$index, scope.row)"
                    >{{ scope.row.isEdit ? "保存" : "编辑" }}</el-button
                  >
                  <el-button
                    @click.native.prevent="
                      deleteRow(scope.$index, tableData, scope.row)
                    "
                    type="danger"
                    plain
                    size="mini"
                  >
                    删除
                  </el-button>
                </template>
              </el-table-column>
  ```

- methods中写方法
  ```vue
  // 删除按钮
      deleteRow(index, rows, row) {
        rows.splice(index, 1);
        let json_data = JSON.stringify(row);
        console.log(json_data);
        const url = "http://127.0.0.1:8000/load/deletedata/";
        axios
          .post(
            url,
            { json_data },
            {
              headers: { "Content-Type": "application/x-www-form-urlencoded" }
            }
          )
          .then(res => {
            console.log("删除成功");
          });
      },
  ```

  

### 1.3 后端

- views.py

```python
# 删除数据


def DeleteData(request):
    """
    Delete data
    """
    if request.method == "POST":
        body_data = request.body
        print(body_data)
        data_json = json.loads(body_data)
        query_data_json = data_json['json_data']
        dict_data = json.loads(query_data_json)
        front_query_oid = dict_data['_id']
        front_query_id = front_query_oid['$oid']
        print(front_query_id)

        # 连接数据库
        client = pymongo.MongoClient("192.168.55.110", 20000)
        database = "segyfile"
        db = client[database]
        collection = "excel_data"
        db_coll = db[collection]

        db_coll.remove({"_id": ObjectId(front_query_id)})
        print("Delete Success")
        # 关闭连接
        client.close()

    return HttpResponse("Delete Success")

```



- [ref](http://mazhaoyang.cn/index.php/Home/ArticleList/ArticleArticle/aid/187/sid/53.html)



## 2、添加数据

### 2.1 前端

- Data.vue

  ```
  
  ```

  

### 2.2 后端

- views.py

  ```
  
  ```

  

- [ref](https://blog.csdn.net/weixin_42614080/article/details/104216967)